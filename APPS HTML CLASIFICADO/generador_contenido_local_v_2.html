<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Contenido Local IA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f79648 0%, #7995b6 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 1200px;
            width: 100%;
            padding: 30px;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
        }

        .sidebar {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            border-left: 4px solid #3b82f6;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            color: #1e293b;
            font-size: 2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .status-online {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }

        .status-offline {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-online .status-dot {
            background: #22c55e;
            animation: pulse 2s infinite;
        }

        .status-offline .status-dot {
            background: #ef4444;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .model-selector {
            margin-bottom: 20px;
        }

        .model-selector label {
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            display: block;
        }

        select,
        input,
        textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        select:focus,
        input:focus,
        textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .template-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
        }

        .template-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .template-card.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .template-icon {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            display: block;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .result-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e5e7eb;
            min-height: 200px;
        }

        .result-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f1f5f9;
        }

        .result-content {
            line-height: 1.6;
            color: #374151;
            white-space: pre-wrap;
            font-size: 15px;
        }

        .platform-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .platform-tag {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .platform-tag.linkedin {
            background: #0077b5;
            color: white;
        }

        .platform-tag.instagram {
            background: #e4405f;
            color: white;
        }

        .platform-tag.facebook {
            background: #1877f2;
            color: white;
        }

        .platform-tag.whatsapp {
            background: #25d366;
            color: white;
        }

        .platform-tag.twitter {
            background: #1da1f2;
            color: white;
        }

        .platform-tag.blog {
            background: #6b7280;
            color: white;
        }

        .settings-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-section h3 {
            color: #374151;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .slider-group {
            margin-bottom: 15px;
        }

        .slider-group label {
            font-size: 13px;
            color: #6b7280;
            margin-bottom: 5px;
            display: block;
        }

        input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }

        .slider-value {
            text-align: center;
            font-size: 12px;
            color: #9ca3af;
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 2px solid #f1f5f9;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #3b82f6;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            font-weight: 500;
        }

        @media (max-width: 968px) {
            .container {
                grid-template-columns: 1fr;
                padding: 20px;
            }

            .sidebar {
                order: 2;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="sidebar">
            <div class="header">
                <h1>ü§ñ IA Local</h1>
                <div id="connectionStatus" class="status-indicator status-offline">
                    <div class="status-dot"></div>
                    <span>Desconectado de Ollama</span>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="postsGenerated">0</div>
                    <div class="stat-label">Posts Generados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="wordsCount">0</div>
                    <div class="stat-label">Palabras Totales</div>
                </div>
            </div>

            <div class="settings-section">
                <h3>‚öôÔ∏è Configuraci√≥n del Modelo</h3>

                <div class="model-selector">
                    <label for="modelSelect">Modelo:</label>
                    <select id="modelSelect">
                        <option value="qwen3:4b">qwen3:4b</option>
                        <option value="orca-mini-3b-gguf2-q4_0.gguf">orca-mini-3b</option>
                        <option value="qwen2:7b">Qwen2 7B (Espa√±ol)</option>
                        <option value="mistral:7b">Mistral 7B (Equilibrado)</option>
                    </select>
                </div>

                <div class="slider-group">
                    <label for="temperature">Creatividad (Temperature):</label>
                    <input type="range" id="temperature" min="0.1" max="1.0" step="0.1" value="0.7">
                    <div class="slider-value" id="tempValue">0.7</div>
                </div>

                <div class="slider-group">
                    <label for="maxTokens">Longitud m√°xima:</label>
                    <input type="range" id="maxTokens" min="100" max="1000" step="50" value="300">
                    <div class="slider-value" id="tokensValue">300 tokens</div>
                </div>
            </div>

            <div class="settings-section">
                <h3>üéØ Plantillas R√°pidas</h3>
                <div class="template-grid">
                    <div class="template-card" data-template="educativo">
                        <div class="template-icon">üìö</div>
                        <div>Educativo</div>
                    </div>
                    <div class="template-card" data-template="promocional">
                        <div class="template-icon">üì¢</div>
                        <div>Promocional</div>
                    </div>
                    <div class="template-card" data-template="caso">
                        <div class="template-icon">üîç</div>
                        <div>Caso</div>
                    </div>
                    <div class="template-card" data-template="tips">
                        <div class="template-icon">üí°</div>
                        <div>Tips</div>
                    </div>
                </div>
            </div>

            <button id="testConnection" class="btn-secondary">
                üîå Probar Conexi√≥n
            </button>
        </div>

        <div class="main-content">
            <div class="form-group">
                <label for="serviceType">üéØ Tipo de Servicio:</label>
                <select id="serviceType">
                    <option value="legal">‚öñÔ∏è Legal Forense</option>
                    <option value="cyber">üõ°Ô∏è Ciberseguridad</option>
                    <option value="general">üîÑ General/Mixto</option>
                </select>
            </div>

            <div class="form-group">
                <label for="platforms">üì± Plataformas objetivo:</label>
                <div class="platform-tags">
                    <div class="platform-tag linkedin" data-platform="linkedin">LinkedIn</div>
                    <div class="platform-tag instagram" data-platform="instagram">Instagram</div>
                    <div class="platform-tag facebook" data-platform="facebook">Facebook</div>
                    <div class="platform-tag whatsapp" data-platform="whatsapp">WhatsApp</div>
                    <div class="platform-tag twitter" data-platform="twitter">Twitter</div>
                    <div class="platform-tag blog" data-platform="blog">Blog</div>
                </div>
            </div>

            <div class="form-group">
                <label for="topic">üìù Tema o concepto clave:</label>
                <input type="text" id="topic"
                    placeholder="Ej: Investigaci√≥n OSINT, Vulnerabilidades web, An√°lisis forense...">
            </div>

            <div class="form-group">
                <label for="context">üìã Contexto adicional (opcional):</label>
                <textarea id="context"
                    placeholder="Proporciona m√°s detalles, audiencia objetivo, tono deseado, etc."></textarea>
            </div>

            <div class="button-group">
                <button id="generateContent" class="btn-primary">
                    <span id="generateIcon">‚ú®</span>
                    <span id="generateText">Generar Contenido</span>
                </button>
                <button id="clearForm" class="btn-secondary">üóëÔ∏è Limpiar</button>
                <button id="exportContent" class="btn-success">üíæ Exportar</button>
            </div>

            <div class="result-container">
                <div class="result-header">
                    <h3>üìÑ Contenido Generado</h3>
                    <button id="copyContent" class="btn-secondary" style="padding: 8px 16px; font-size: 12px;">
                        üìã Copiar
                    </button>
                </div>
                <div class="result-content" id="resultContent">
                    El contenido generado aparecer√° aqu√≠...
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration y estado global
        const config = {
            ollamaUrl: 'http://localhost:11434',
            currentModel: 'qwen3:4b',
            isConnected: false,
            stats: {
                postsGenerated: 0,
                wordsCount: 0
            }
        };

        // Templates predefinidos
        const templates = {
            educativo: {
                legal: "Explica de manera clara y profesional el concepto de {topic} en el √°mbito legal forense. Incluye su importancia, aplicaciones pr√°cticas y c√≥mo impacta en la investigaci√≥n criminal√≠stica. Usa un tono educativo pero accesible.",
                cyber: "Explica qu√© es {topic} en ciberseguridad de manera clara y profesional. Incluye por qu√© es importante, c√≥mo funciona y consejos pr√°cticos para implementarlo. Usa ejemplos reales sin ser demasiado t√©cnico."
            },
            promocional: {
                legal: "Crea un post promocional sobre nuestros servicios de {topic} en investigaci√≥n forense. Resalta los beneficios √∫nicos, nuestra experiencia y c√≥mo podemos ayudar. Incluye call-to-action profesional.",
                cyber: "Crea contenido promocional sobre nuestros servicios de {topic} en ciberseguridad. Destaca nuestras herramientas avanzadas como XIPHOS y AKONTIA, ventajas competitivas y valor para el cliente."
            },
            caso: {
                legal: "Describe un caso de estudio (ficticio pero realista) relacionado con {topic} en investigaci√≥n forense. Explica el problema, metodolog√≠a usada, hallazgos y conclusiones. Mant√©n confidencialidad profesional.",
                cyber: "Presenta un caso de estudio sobre {topic} en ciberseguridad. Describe la situaci√≥n, herramientas utilizadas, proceso de an√°lisis y resultados. Enf√≥cate en el valor de nuestra metodolog√≠a."
            },
            tips: {
                legal: "Proporciona 3-5 tips profesionales sobre {topic} en el √°mbito forense. Cada tip debe ser pr√°ctico, aplicable y respaldado por la experiencia. Usa numeraci√≥n y mant√©n un tono experto.",
                cyber: "Lista 3-5 consejos expertos sobre {topic} en ciberseguridad. Cada consejo debe ser accionable y valioso. Incluye por qu√© es importante cada tip y c√≥mo implementarlo."
            }
        };

        // DOM Elements
        const elements = {
            connectionStatus: document.getElementById('connectionStatus'),
            modelSelect: document.getElementById('modelSelect'),
            temperature: document.getElementById('temperature'),
            maxTokens: document.getElementById('maxTokens'),
            tempValue: document.getElementById('tempValue'),
            tokensValue: document.getElementById('tokensValue'),
            serviceType: document.getElementById('serviceType'),
            topic: document.getElementById('topic'),
            context: document.getElementById('context'),
            generateContent: document.getElementById('generateContent'),
            generateIcon: document.getElementById('generateIcon'),
            generateText: document.getElementById('generateText'),
            resultContent: document.getElementById('resultContent'),
            testConnection: document.getElementById('testConnection'),
            clearForm: document.getElementById('clearForm'),
            copyContent: document.getElementById('copyContent'),
            exportContent: document.getElementById('exportContent'),
            postsGenerated: document.getElementById('postsGenerated'),
            wordsCount: document.getElementById('wordsCount')
        };

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function () {
            initializeApp();
            setupEventListeners();
            testOllamaConnection();
        });

        function initializeApp() {
            // Cargar datos desde localStorage si existen
            const savedStats = localStorage.getItem('contentGeneratorStats');
            if (savedStats) {
                config.stats = JSON.parse(savedStats);
                updateStats();
            }

            // Configurar sliders
            elements.temperature.addEventListener('input', (e) => {
                elements.tempValue.textContent = e.target.value;
            });

            elements.maxTokens.addEventListener('input', (e) => {
                elements.tokensValue.textContent = e.target.value + ' tokens';
            });
        }

        function setupEventListeners() {
            // Template selection
            document.querySelectorAll('.template-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.template-card').forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                });
            });

            // Platform selection
            document.querySelectorAll('.platform-tag').forEach(tag => {
                tag.addEventListener('click', () => {
                    tag.style.opacity = tag.style.opacity === '0.5' ? '1' : '0.5';
                });
            });

            // Main buttons
            elements.generateContent.addEventListener('click', generateContent);
            elements.testConnection.addEventListener('click', testOllamaConnection);
            elements.clearForm.addEventListener('click', clearForm);
            elements.copyContent.addEventListener('click', copyToClipboard);
            elements.exportContent.addEventListener('click', exportContent);

            // Model change
            elements.modelSelect.addEventListener('change', (e) => {
                config.currentModel = e.target.value;
            });
        }

        async function testOllamaConnection() {
            elements.testConnection.classList.add('loading');
            elements.testConnection.innerHTML = '<div class="spinner"></div> Probando...';

            try {
                const response = await fetch(`${config.ollamaUrl}/api/tags`);
                if (response.ok) {
                    config.isConnected = true;
                    elements.connectionStatus.className = 'status-indicator status-online';
                    elements.connectionStatus.innerHTML = '<div class="status-dot"></div><span>Conectado a Ollama</span>';
                    elements.testConnection.innerHTML = '‚úÖ Conectado';
                } else {
                    throw new Error('No se pudo conectar');
                }
            } catch (error) {
                config.isConnected = false;
                elements.connectionStatus.className = 'status-indicator status-offline';
                elements.connectionStatus.innerHTML = '<div class="status-dot"></div><span>Error: Verificar Ollama</span>';
                elements.testConnection.innerHTML = '‚ùå Error';
            } finally {
                elements.testConnection.classList.remove('loading');
                setTimeout(() => {
                    elements.testConnection.innerHTML = 'üîå Probar Conexi√≥n';
                }, 2000);
            }
        }

        async function generateContent() {
            if (!config.isConnected) {
                alert('‚ùå No hay conexi√≥n con Ollama. Verifica que est√© ejecut√°ndose en localhost:11434');
                return;
            }

            const topic = elements.topic.value.trim();
            if (!topic) {
                alert('‚ö†Ô∏è Por favor ingresa un tema');
                return;
            }

            // UI Loading state
            elements.generateContent.classList.add('loading');
            elements.generateIcon.innerHTML = '<div class="spinner"></div>';
            elements.generateText.textContent = 'Generando...';
            elements.resultContent.textContent = 'Generando contenido con IA local...';

            try {
                const serviceType = elements.serviceType.value;
                const selectedTemplate = document.querySelector('.template-card.active');
                const templateType = selectedTemplate ? selectedTemplate.dataset.template : 'educativo';
                const context = elements.context.value.trim();

                // Construir prompt
                let prompt = templates[templateType][serviceType] || templates[templateType]['legal'];
                prompt = prompt.replace('{topic}', topic);

                if (context) {
                    prompt += `\n\nContexto adicional: ${context}`;
                }

                // Configuraci√≥n para la plataforma
                const selectedPlatforms = Array.from(document.querySelectorAll('.platform-tag'))
                    .filter(tag => tag.style.opacity !== '0.5')
                    .map(tag => tag.dataset.platform);

                if (selectedPlatforms.length > 0) {
                    prompt += `\n\nOptimiza el contenido para: ${selectedPlatforms.join(', ')}`;
                }

                prompt += '\n\nRespuesta en espa√±ol. S√© profesional, informativo y atractivo.';

                // Llamada a Ollama
                const response = await fetch(`${config.ollamaUrl}/api/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: config.currentModel,
                        prompt: prompt,
                        stream: false,
                        options: {
                            temperature: parseFloat(elements.temperature.value),
                            max_tokens: parseInt(elements.maxTokens.value),
                            top_p: 0.9
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }

                const data = await response.json();
                const generatedContent = data.response;

                // Mostrar resultado
                elements.resultContent.textContent = generatedContent;

                // Actualizar estad√≠sticas
                config.stats.postsGenerated++;
                config.stats.wordsCount += generatedContent.split(' ').length;
                updateStats();
                saveStats();

            } catch (error) {
                console.error('Error:', error);
                elements.resultContent.textContent = `‚ùå Error al generar contenido: ${error.message}`;
            } finally {
                // Reset UI
                elements.generateContent.classList.remove('loading');
                elements.generateIcon.textContent = '‚ú®';
                elements.generateText.textContent = 'Generar Contenido';
            }
        }

        function clearForm() {
            elements.topic.value = '';
            elements.context.value = '';
            elements.resultContent.textContent = 'El contenido generado aparecer√° aqu√≠...';

            // Reset platform selections
            document.querySelectorAll('.platform-tag').forEach(tag => {
                tag.style.opacity = '1';
            });

            // Reset template
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('active');
            });
        }

        function copyToClipboard() {
            const content = elements.resultContent.textContent;
            if (content && content !== 'El contenido generado aparecer√° aqu√≠...') {
                navigator.clipboard.writeText(content).then(() => {
                    elements.copyContent.textContent = '‚úÖ Copiado';
                    setTimeout(() => {
                        elements.copyContent.innerHTML = 'üìã Copiar';
                    }, 2000);
                });
            }
        }

        function exportContent() {
            const content = elements.resultContent.textContent;
            const topic = elements.topic.value || 'contenido';

            if (content && content !== 'El contenido generado aparecer√° aqu√≠...') {
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `contenido_${topic.replace(/\s+/g, '_')}_${Date.now()}.txt`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        function updateStats() {
            elements.postsGenerated.textContent = config.stats.postsGenerated;
            elements.wordsCount.textContent = config.stats.wordsCount.toLocaleString();
        }

        function saveStats() {
            localStorage.setItem('contentGeneratorStats', JSON.stringify(config.stats));
        }

        // Auto-test connection every 30 seconds
        setInterval(() => {
            if (!config.isConnected) {
                testOllamaConnection();
            }
        }, 30000);
    </script>
</body>

</html>